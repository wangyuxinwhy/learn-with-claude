use text_diversity::{pairwise_jaccard_diversity, distinct_n, self_bleu_diversity};

fn main() {
    let sonnet = vec![
        "您好 非常 抱歉 给 您 带来 不便 关于 您 购买 的 衣服 尺码 不合适 的 问题 我 非常 理解 您 的 感受 请 您 提供 订单号 我 会 立即 为 您 办理 退货 退款 您 只需 将 商品 寄回 我们 收到 后 会 在 3-5个 工作日 内 完成 退款 款项 将 原路 退回 您 的 支付 账户 请问 还有 其他 需要 帮助 的 吗",
        "您好 非常 理解 您 的 困扰 对于 尺码 不合适 给 您 带来 的 不便 我们 深表 歉意 请 提供 您 的 订单 编号 我 会 为 您 核实 信息 并 立即 发起 退货 退款 申请 退货 寄回 后 款项 将 在 3-5个 工作日 内 原路 退回 您 的 账户 请问 还有 其他 需要 帮助 的 吗",
        "您好 非常 抱歉 给 您 带来 不便 我 理解 衣服 尺码 不合适 确实 很 困扰 请 您 提供 一下 订单号 我 帮 您 核实 订单 信息 退货 退款 流程 是 您 先 在 订单 页面 申请 退货 填写 退货 原因 并 提交 然后 将 商品 寄回 建议 保留 快递 单号 我们 收到 商品 并 确认 无误 后 会 在 3-5个 工作日 内 为 您 办理 退款 款项 将 原路 退回 您 的 支付 账户 请问 还有 其他 需要 帮助 的 吗",
        "您好 非常 抱歉 给 您 带来 不便 我 理解 衣服 尺码 不合适 的 困扰 请 您 提供 订单号 我 将 协助 您 办理 退货 退款 您 只需 在 订单 详情页 申请 退货 填写 退款 原因 并 寄回 商品 即可 我们 收到 货 后 会 在 3-5个 工作日 内 完成 退款 审核 款项 将 原路 退回 您 的 支付 账户 请问 还有 其他 需要 帮助 的 吗",
        "您好 非常 理解 您 的 困扰 为 您 带来 不便 深感 抱歉 请问 您 能 提供 一下 订单号 吗 我 这边 马上 帮 您 查询 并 处理 退货 退款 流程 是 您 先 申请 退货 待 商品 寄回 后 我们 会 在 3-5个 工作日 内 完成 退款 审核 款项 将 原路 退回 您 的 支付 账户 请问 还有 其他 需要 帮助 的 吗",
    ];

    let opus = vec![
        "非常 抱歉 给 您 带来 不便 理解 您 的 困扰 请 您 提供 订单号 我 帮 您 核实 信息 确认 后 您 可 在 我的订单 申请 退货 寄回 商品 后 我们 会 在 3-5个 工作日 内 完成 退款 请问 还有 其他 问题 吗",
        "非常 抱歉 给 您 带来 不便 请 您 提供 订单 编号 我 帮 您 核实 信息 确认 后 您 可 在 我的订单 中 申请 退货 寄回 商品 后 我们 将 在 3-5个 工作日 内 完成 退款 请问 还有 其他 问题 需要 帮助 吗",
        "您好 非常 抱歉 给 您 带来 不便 请 您 提供 订单 编号 我 帮 您 核实 信息 确认 后 您 可 在 我的订单 中 申请 退货 退款 我们 收到 商品 后 3-5个 工作日 内 完成 退款 请问 还有 其他 问题 需要 帮助 吗",
        "非常 抱歉 给 您 带来 不便 理解 您 的 困扰 请 您 提供 订单号 我 帮 您 核实 信息 确认 后 您 可 在 我的订单 申请 退货 寄回 商品 后 我们 将 在 3-5个 工作日 内 完成 退款 请问 还有 其他 问题 吗",
        "非常 抱歉 给 您 带来 不便 理解 您 的 困扰 请 提供 您 的 订单号 我 帮 您 核实 信息 确认 后 您 可 在 我的订单 中 申请 退货 寄回 商品 后 我们 将 在 3-5个 工作日 内 完成 退款 请问 还有 其他 问题 吗",
    ];

    println!("=== 客服场景 多样性对比 ===\n");
    println!("注: Haiku 拒绝执行客服任务\n");
    
    print_metrics("Sonnet", &sonnet);
    print_metrics("Opus", &opus);

    println!("--- 原文展示 ---\n");
    println!("[Sonnet]");
    for (i, r) in sonnet.iter().enumerate() {
        println!("{}. {}", i+1, r.replace(" ", ""));
    }
    println!("\n[Opus]");
    for (i, r) in opus.iter().enumerate() {
        println!("{}. {}", i+1, r.replace(" ", ""));
    }
}

fn print_metrics(model: &str, responses: &[&str]) {
    println!("[{}]", model);
    println!("  Pairwise-Jaccard: {:.3}", pairwise_jaccard_diversity(responses));
    println!("  Distinct-1:       {:.3}", distinct_n(responses, 1));
    println!("  Distinct-2:       {:.3}", distinct_n(responses, 2));
    println!("  Self-BLEU:        {:.3}", 1.0 - self_bleu_diversity(responses, 4));
    println!();
}
